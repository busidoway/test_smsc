import{r as i,a as F,k as w,b as m,d as N,c as u,e as s,f as y,w as x,l as g,v as k,F as S,g as j,h as D,o as _,i as h,t as v,j as L}from"./app-DSpamfmE.js";import{o as T}from"./index-L9GtX3dQ.js";const B={class:"sendsms"},M=s("h4",{class:"py-3 mb-4"},"Рассылки",-1),O={class:"card"},I={class:"d-flex justify-content-between align-items-center py-2"},J=s("h5",{class:"card-header"},"Список рассылок",-1),R={class:"px-4"},U={class:"card-body"},$={class:"row mb-4"},E={class:"col-sm-6 col-md-2 d-flex align-items-center"},q=s("span",null,"Период",-1),z=s("span",{class:"ms-1 me-2"},"с",-1),A={class:"col-sm-6 col-md-2 d-flex align-items-center"},G=s("span",{class:"me-2"},"по",-1),H={class:"table-responsive text-nowrap"},K={class:"table"},P=s("thead",null,[s("tr",null,[s("th",null,"ID"),s("th",null,"Название"),s("th",null,"Отправлено"),s("th",null,"Доставлено"),s("th")])],-1),Q={class:"table-border-bottom-0"},W={class:"dropdown"},X=["onClick"],Y=s("i",{class:"bx bx-dots-vertical-rounded"},null,-1),Z=[Y],ss=s("i",{class:"bx bx-edit-alt me-1"},null,-1),ts=["onClick"],es=s("i",{class:"bx bx-trash me-1"},null,-1),os={key:0,class:"spinner-wrap d-flex justify-content-center py-3"},as=s("div",{class:"spinner-border",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")],-1),ns=[as],cs={__name:"Sendsms",setup(ls){const d=i([]),n=i(!0),c=i(""),r=i(""),p=i(!1),f=i(null);T(f,o=>p.value=!1),F(()=>{b()}),w(c,o=>{let e="";r.value&&(e=r.value);const a=new FormData,t=JSON.stringify({date_from:o,date_to:e});a.append("data",t),n.value=!0,d.value=[],m.post("/api/sendsms",a).then(l=>{n.value=!1,d.value=l.data.sendsms})}),w(r,o=>{let e="";c.value&&(e=c.value);const a=new FormData,t=JSON.stringify({date_from:e,date_to:o});a.append("data",t),n.value=!0,d.value=[],m.post("/api/sendsms",a).then(l=>{n.value=!1,d.value=l.data.sendsms})});function b(){m.post("/api/sendsms").then(o=>{n.value=!1,d.value=o.data.sendsms})}function C(o){o&&m.post("/api/sendsms_delete/"+o).then(e=>{e.data.status==="success"&&(n.value=!0,b())})}return(o,e)=>{const a=N("RouterLink");return _(),u("div",B,[M,s("div",O,[s("div",I,[J,s("div",R,[y(a,{to:"/sendsms/edit",class:"btn rounded-pill btn-outline-primary"},{default:x(()=>[h("Добавить")]),_:1})])]),s("div",U,[s("div",$,[s("div",E,[q,z,g(s("input",{type:"date",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t)},null,512),[[k,c.value]])]),s("div",A,[G,g(s("input",{type:"date",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>r.value=t)},null,512),[[k,r.value]])])]),s("div",H,[s("table",K,[P,s("tbody",Q,[(_(!0),u(S,null,j(d.value,(t,l)=>(_(),u("tr",null,[s("td",null,v(t.id),1),s("td",null,v(t.name),1),s("td",null,v(t.wait),1),s("td",null,v(t.delivered),1),s("td",null,[s("div",W,[s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow",onClick:V=>p.value=p.value===l?null:l},Z,8,X),p.value===l?(_(),u("div",{key:0,class:"dropdown-menu",style:{display:"block"},ref_for:!0,ref_key:"target",ref:f},[y(a,{class:"dropdown-item",to:"/sendsms/edit/"+t.id},{default:x(()=>[ss,h(" Редактировать")]),_:2},1032,["to"]),s("a",{class:"dropdown-item cursor-pointer",onClick:L(V=>C(t.id),["prevent"])},[es,h(" Удалить")],8,ts)],512)):D("",!0)])])]))),256))])]),n.value?(_(),u("div",os,ns)):D("",!0)])])])])}}};export{cs as default};
